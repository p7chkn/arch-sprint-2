# mongo-sharding

Мы добавили 2 шарда в наше приложение, теперь нам нужно добавить так же сервер конфигурации и роутер, которые будет распределять запросы.
Наше приложение теперь подключается в роутер, а не напрямую к базе данных.
Теперь процесс инициализации приложение усложняется инициализацией DB:
- для начала нам надо запустить все контейнеры
- затем инициализировать сервер конфигураций
- инициализировать все шарды
- потом инициализировать роутер

Все это можно уложить в пару скриптов, что тут и сделано.

## Как запустить

Поднимаем сервисы mongodb и приложение

```shell
docker compose up -d
```

Инициализируем базу данных с шардами:
```shell
./scripts/mongo-init.sh
```

Заполняем mongodb данными и инициализируем роутер:

```shell
./scripts/mongo-fill.sh
```

## Как проверить

### Если вы запускаете проект на локальной машине

Откройте в браузере http://localhost:8080

### Если вы запускаете проект на предоставленной виртуальной машине

Узнать белый ip виртуальной машины

```shell
curl --silent http://ifconfig.me
```

Откройте в браузере http://<ip виртуальной машины>:8080

### Так же кол-во документов в шардах можно посмотреть при помощи команды:

```shell
./scripts/mongo-count-shards.sh
```

## Доступные эндпоинты

Список доступных эндпоинтов, swagger http://<ip виртуальной машины>:8080/docs
